import{_ as x,u as y,b as d,d as I,m as w,e as g,o as u,i as k,a as t,h as c,v as m,c as f,F as S,G as V,I as v,N as B,W as D,O as i}from"./index-COq8Ttir.js";const N={class:"container mt-4"},U={class:"mb-3"},O={class:"attendance-table"},A=["onUpdate:modelValue"],J=["onUpdate:modelValue","disabled"],M={__name:"Attendance",setup(C){const b=y(),n=d(new Date().toISOString().slice(0,10)),h=d([]),o=I({data:[],courseId:""});w(async()=>{const s=history.state.data,e=history.state.id,a=JSON.parse(s);o.data=a.map(r=>({...r,status:r.status??"결석",note:r.note??""}));const l=JSON.parse(e);o.courseId=l,console.log("스테이트데이타:",o.data),console.log("라우팅 아이디:",o.courseId)});const p=d(!1),_=async()=>{if(!n.value){alert("출결일자를 선택해주세요.");return}p.value=!0;try{for(const s of h.value){if(!s.status){alert(`학생 ${s.name}의 출결 상태를 선택해주세요.`);return}const e={attendDate:n.value,enrollmentId:s.enrollmentId,status:s.status,note:s.note},{data:a}=await i.post("/professor/course/check/exist",e);a===0?await i.post("/professor/course/check",e):await i.put("/professor/course/check",e)}alert("출결 저장 완료!"),await b.push("/professor/attendance")}catch(s){console.error("출결 저장 중 오류:",s),alert("출결 저장 중 오류가 발생했습니다.")}finally{p.value=!1}};return(s,e)=>(u(),g(D,{title:"출결 관리"},{default:k(()=>[t("div",N,[e[4]||(e[4]=t("h2",{class:"text-center fw-bold mb-4"},"출결 입력창",-1)),t("div",U,[e[1]||(e[1]=t("label",{class:"form-label"},"출결일자",-1)),c(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=a=>n.value=a),class:"form-control w-25"},null,512),[[m,n.value]])]),t("table",O,[e[3]||(e[3]=t("thead",{class:"grade-table-header"},[t("tr",null,[t("th",null,"이름"),t("th",null,"학번"),t("th",null,"출결 상태"),t("th",null,"비고")])],-1)),t("tbody",null,[(u(!0),f(S,null,V(o.data,a=>(u(),f("tr",{key:a.enrollmentId},[t("td",null,v(a.userName),1),t("td",null,v(a.loginId),1),t("td",null,[c(t("select",{"onUpdate:modelValue":l=>a.status=l,class:"form-select"},e[2]||(e[2]=[t("option",{disabled:"",value:""},"선택",-1),t("option",{value:"출석"},"출석",-1),t("option",{value:"지각"},"지각",-1),t("option",{value:"결석"},"결석",-1),t("option",{value:"병가"},"병가",-1),t("option",{value:"경조사"},"경조사",-1)]),8,A),[[B,a.status]])]),t("td",null,[c(t("input",{"onUpdate:modelValue":l=>a.note=l,disabled:!["지각","병가","경조사"].includes(a.status),class:"form-control",placeholder:"사유 입력"},null,8,J),[[m,a.note]])])]))),128))])]),t("div",{class:"text-center mt-4"},[t("button",{onClick:_,class:"btn btn-primary px-4"}," 저장 ")])])]),_:1}))}},L=x(M,[["__scopeId","data-v-5c76e25f"]]);export{L as default};
