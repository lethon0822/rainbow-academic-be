import{P as u,_ as C,a as V,k as h,q as k,t as c,c as _,o as x,b as o,C as a,h as d,g as n,v as i}from"./index-BYEgPVgA.js";import{W as m}from"./WhiteBox-2PWihVXJ.js";import{s as U,c as $}from"./emailService-Qq0qxlq4.js";/* empty css                                                                 */const N=()=>u.get("/account/privacy").catch(r=>r.response),T=r=>u.put("/account/privacy",r).catch(s=>s.response),B=r=>u.put("/account/renewal",r).catch(s=>s.response),D={class:"page"},I={class:"grid-2"},A={class:"form-item"},z={class:"form-item"},R={class:"grid-2"},j={class:"form-item"},E={class:"hstack"},M={class:"form-item col-2"},S={class:"form-item col-2"},W={class:"form-item"},q={class:"form-item"},O={class:"grid-2"},Y={class:"form-item col-2"},F={class:"hstack hstack-auth"},G=["disabled"],H={class:"form-item"},J={class:"form-item"},K={class:"actions"},L=["disabled"],Q={__name:"RenewalPrivacy",setup(r){const s=V({form:{loginId:"",userName:"",address:"",addDetail:"",phone:"",email:"",authCode:"",newPassword:"",confirmPassword:"",isVerified:!1},verifiedToken:null});h(async()=>{const t=await N();Object.assign(s.form,t.data)});const f=k(()=>s.form.isVerified);function b(t){var l;let e=(((l=t==null?void 0:t.target)==null?void 0:l.value)??s.form.phone).replace(/\D/g,"").slice(0,11);e.length<4?s.form.phone=e:e.length<8?s.form.phone=`${e.slice(0,3)}-${e.slice(3)}`:s.form.phone=`${e.slice(0,3)}-${e.slice(3,7)}-${e.slice(7)}`}function v(){new daum.Postcode({oncomplete:function(t){let e="",l="";t.userSelectedType==="R"?e=t.roadAddress:e=t.jibunAddress,t.userSelectedType==="R"&&(t.bname!==""&&/(동|로|가)$/.test(t.bname)&&(l+=t.bname),t.buildingName!==""&&t.apartment==="Y"&&(l+=l!==""?", "+t.buildingName:t.buildingName),l!==""&&(l=" ("+l+")")),s.form.zipcode=t.zonecode,s.form.address=e+l,setTimeout(()=>{var p;(p=document.getElementById("sample6_detailAddress"))==null||p.focus()},0)}}).open()}async function w(){const t=T(s.form);console.log(t),alert("저장되었습니다.")}async function y(){if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(s.form.email)){alert("올바른 이메일을 입력하세요.");return}try{const t=await U({email:s.form.email});t&&t.status===200&&alert("등록된 이메일로 인증번호가 전송되었습니다.")}catch{}}async function g(){if(!/^\d{6}$/.test(s.form.authCode)){alert("6자리 숫자를 입력하세요.");return}try{const t=await $({email:s.form.email,authCode:s.form.authCode});t&&t.status===200?(alert("인증 성공"),s.form.isVerified=!0):alert("인증 실패")}catch{alert("인증 실패22")}}async function P(){if(!(!f.value&&s.form.newPassword!==s.form.confirmPassword))try{const t=await B({jsonBody:s.form.newPassword});t&&t.status===200?(alert("비밀번호가 변경되었습니다."),s.form.newPassword="",s.form.confirmPassword="",s.form.authCode="",s.form.isVerified=!1,s.verifiedToken=null):alert("비밀번호 변경에 실패했습니다.")}catch(t){console.error(t),alert("비밀번호 변경 중 오류가 발생했습니다.")}}return c(()=>s.form.email,()=>{s.form.isVerified=!1,s.verifiedToken=null}),c(()=>s.form.authCode,()=>{s.form.isVerified=!1,s.verifiedToken=null}),(t,e)=>(x(),_("div",D,[e[22]||(e[22]=o("h1",{class:"page-title"},"개인정보변경",-1)),a(m,{class:"wb"},{default:d(()=>[o("div",I,[o("div",A,[e[10]||(e[10]=o("label",null,"학번",-1)),n(o("input",{class:"input","onUpdate:modelValue":e[0]||(e[0]=l=>s.form.loginId=l)},null,512),[[i,s.form.loginId]])]),o("div",z,[e[11]||(e[11]=o("label",null,"이름",-1)),n(o("input",{class:"input","onUpdate:modelValue":e[1]||(e[1]=l=>s.form.userName=l)},null,512),[[i,s.form.userName]])])])]),_:1}),a(m,{class:"wb wb--accent"},{default:d(()=>[e[17]||(e[17]=o("div",{class:"section-title"},"본인정보",-1)),o("div",R,[o("div",j,[e[12]||(e[12]=o("label",null,"우편번호",-1)),o("div",E,[n(o("input",{class:"input","onUpdate:modelValue":e[2]||(e[2]=l=>s.form.zipcode=l),readonly:""},null,512),[[i,s.form.zipcode]]),o("button",{class:"btn btn-outline",onClick:v}," 주소찾기 ")])]),o("div",M,[e[13]||(e[13]=o("label",null,"주소",-1)),n(o("input",{class:"input","onUpdate:modelValue":e[3]||(e[3]=l=>s.form.address=l),readonly:""},null,512),[[i,s.form.address]])]),o("div",S,[e[14]||(e[14]=o("label",null,"상세주소",-1)),n(o("input",{id:"sample6_detailAddress",class:"input","onUpdate:modelValue":e[4]||(e[4]=l=>s.form.addDetail=l)},null,512),[[i,s.form.addDetail]])]),o("div",W,[e[15]||(e[15]=o("label",null,"전화번호",-1)),n(o("input",{class:"input","onUpdate:modelValue":e[5]||(e[5]=l=>s.form.phone=l),onInput:b},null,544),[[i,s.form.phone]])]),o("div",q,[e[16]||(e[16]=o("label",null,"Email",-1)),n(o("input",{class:"input","onUpdate:modelValue":e[6]||(e[6]=l=>s.form.email=l)},null,512),[[i,s.form.email]])])]),o("div",{class:"actions"},[o("button",{class:"btn btn-primary",onClick:w},"저장")])]),_:1,__:[17]}),a(m,{class:"wb"},{default:d(()=>[e[21]||(e[21]=o("div",{class:"section-title"},"비밀번호 변경",-1)),o("div",O,[o("div",Y,[e[18]||(e[18]=o("label",null,"인증번호",-1)),o("div",F,[n(o("input",{type:"text",class:"input input-auth","onUpdate:modelValue":e[7]||(e[7]=l=>s.form.authCode=l),placeholder:"인증번호 입력",inputmode:"numeric",maxlength:"6"},null,512),[[i,s.form.authCode]]),o("button",{type:"button",class:"btn btn-blue",onClick:y}," 인증번호 발송 "),o("button",{class:"btn btn-blue",disabled:!/^\d{6}$/.test(s.form.authCode),onClick:g}," 인증번호 확인 ",8,G)])]),o("div",H,[e[19]||(e[19]=o("label",null,"신규 비밀번호",-1)),n(o("input",{type:"password",class:"input","onUpdate:modelValue":e[8]||(e[8]=l=>s.form.newPassword=l),placeholder:"비밀번호"},null,512),[[i,s.form.newPassword]])]),o("div",J,[e[20]||(e[20]=o("label",null,"신규 비밀번호 확인",-1)),n(o("input",{type:"password",class:"input","onUpdate:modelValue":e[9]||(e[9]=l=>s.form.confirmPassword=l),placeholder:"비밀번호 확인"},null,512),[[i,s.form.confirmPassword]])])]),o("div",K,[o("button",{class:"btn btn-primary",disabled:!f.value,onClick:P}," 비밀번호 변경 ",8,L)])]),_:1,__:[21]})]))}},oe=C(Q,[["__scopeId","data-v-4c4a75f5"]]);export{oe as default};
