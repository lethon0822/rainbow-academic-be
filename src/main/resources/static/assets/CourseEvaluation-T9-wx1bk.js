import{r as a,u as Q,z as H,q as D,k as J,c as u,o as i,b as s,H as n,f as g,Y,e as m,F as G,E as W,g as X,v as Z,J as ee,w as se,P as h}from"./index-BYEgPVgA.js";const te={class:"survey-container"},le={class:"course-info"},oe={key:0,class:"loading-container"},ae={key:1,class:"error-container"},ne={class:"error-message"},re={key:2,class:"row"},ue={class:"col-md-6"},ie={class:"col-md-6"},ce={class:"progress"},de={class:"text-center text-muted mb-4"},ve={key:0,class:"survey-item"},pe={class:"question-header"},me={class:"question-number"},be={class:"question-text"},ye={class:"rating-container"},_e={class:"rating-scale"},fe={class:"rating-label"},ge={class:"rating-input-wrapper"},he=["name","id","value","data-value","onInput","checked","disabled"],qe={key:1,class:"survey-item"},Ie={class:"rating-container"},we=["disabled"],ke={class:"survey-footer"},xe=["disabled"],Se=["disabled"],Ce=["disabled"],De=["disabled"],Ee={key:2,class:"alert alert-success mt-4"},d=5,Pe={__name:"CourseEvaluation",props:{courseId:String},setup(E){const N=E,q=a(null),P=a(!0),L=Q(),O=H(),b=a(N.courseId||O.query.courseId||""),c=a({q1:null,q2:null,q3:null,q4:null,q5:null}),I=a(0),r=a(!1),y=a(""),o=a(1),v=a({courseId:null,title:"",credit:"",professorName:"",type:"",classroom:"",year:"",semester:"",evaluation_date:""}),w=a(!0),_=a(null),k=a(null),S=[{number:1,question:"ìˆ˜ì—…ë‚´ìš©ì´ ì²´ê³„ì ìœ¼ë¡œ êµ¬ì„±ë˜ì—ˆë‹¤."},{number:2,question:"êµìˆ˜ì˜ ê°•ì˜ ì§„í–‰ ì†ë„ê°€ ì ì ˆí•˜ë‹¤."},{number:3,question:"ìˆ˜ì—… ìë£Œ(PPT, êµì¬ ë“±)ê°€ ì´í•´í•˜ê¸° ì‰½ê²Œ ì¤€ë¹„ë˜ì—ˆë‹¤."},{number:4,question:"êµìˆ˜ê°€ í•™ìƒë“¤ì˜ ì§ˆë¬¸ì— ì„±ì‹¤íˆ ë‹µë³€í•´ì¤€ë‹¤."},{number:5,question:"ì´ ê°•ì˜ë¥¼ ë‹¤ë¥¸ í•™ìƒë“¤ì—ê²Œ ì¶”ì²œí•˜ê³  ì‹¶ë‹¤."}],j=[{label:"ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤",value:1},{label:"ê·¸ë ‡ì§€ ì•Šë‹¤",value:2},{label:"ë³´í†µì´ë‹¤",value:3},{label:"ê·¸ë ‡ë‹¤",value:4},{label:"ë§¤ìš° ê·¸ë ‡ë‹¤",value:5}],M=async()=>{var t,e;try{const l=await h.get("/account/check");q.value=l.data,console.log("í˜„ì¬ ì‚¬ìš©ì ID:",q.value)}catch(l){console.error("ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:",l),(((t=l.response)==null?void 0:t.status)===401||!((e=l.response)!=null&&e.data))&&alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.")}finally{P.value=!1}},R=t=>h.get(`/course/${t}`).catch(e=>e.response),C=async()=>{try{w.value=!0,_.value=null;const t=await R(b.value);if(t&&t.data){const e=t.data;v.value={courseId:e.courseId||null,title:e.title||"ê³¼ëª©ëª… ì •ë³´ ì—†ìŒ",credit:e.credit!==void 0?e.credit:"í•™ì  ì •ë³´ ì—†ìŒ",professorName:e.userName||"êµìˆ˜ëª… ì •ë³´ ì—†ìŒ",type:e.type||"ì´ìˆ˜êµ¬ë¶„ ì •ë³´ ì—†ìŒ",classroom:e.classroom||"ê°•ì˜ì‹¤ ì •ë³´ ì—†ìŒ",year:e.year||"ë…„ë„ ì •ë³´ ì—†ìŒ",semester:e.semester||"í•™ê¸° ì •ë³´ ì—†ìŒ",evaluation_date:new Date().toLocaleDateString("ko-KR")}}else throw new Error("ê°•ì˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}catch(t){console.error("ê°•ì˜ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:",t),_.value=t.message||"ê°•ì˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",v.value={courseId:null,title:"ê°•ì˜ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨",credit:"ì •ë³´ ì—†ìŒ",professorName:"ì •ë³´ ì—†ìŒ",type:"ì´ìˆ˜êµ¬ë¶„ ì •ë³´ ì—†ìŒ",classroom:"ì •ë³´ ì—†ìŒ",year:"ì •ë³´ ì—†ìŒ",semester:"ì •ë³´ ì—†ìŒ",evaluation_date:new Date().toLocaleDateString("ko-KR")}}finally{w.value=!1}},A=async()=>{try{const t=`/student/course?courseId=${b.value}`;console.log("Enrollment API í˜¸ì¶œ URL:",t);const l=(await h.get(t)).data.find(p=>p.courseId===parseInt(b.value));l?(k.value=l.enrollmentId,console.log("Enrollment ID:",k.value)):console.warn("í•´ë‹¹ ê°•ì˜ì˜ ìˆ˜ê°•ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.")}catch(t){console.error("ìˆ˜ê°•ë‚´ì—­ ë¡œë“œ ì‹¤íŒ¨:",t)}},x=()=>{const t=Object.values(c.value).filter(e=>e!==null).length;I.value=Math.round(t/d*100)},T=t=>{c.value["q"+o.value]=t,x()},U=()=>{o.value<d&&o.value++},V=()=>{o.value>1&&o.value--},z=async()=>{var t;if(!q.value){alert("ì‚¬ìš©ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");return}if(Object.values(c.value).every(e=>e!==null)){const e=Object.values(c.value),l=Math.round(e.reduce((f,K)=>f+K,0)/e.length),p={enrollmentId:k.value,courseId:parseInt(b.value),review:y.value,evScore:l};console.log("ì„¤ë¬¸ ê²°ê³¼:",p);try{await h.put("/student/course/survey",p),r.value=!0,alert(`ì„¤ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!
ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬í•©ë‹ˆë‹¤.`),L.push("/grade/current")}catch(f){console.error("ì„¤ë¬¸ ì œì¶œ ì‹¤íŒ¨:",f),((t=f.response)==null?void 0:t.status)===401?alert("ë¡œê·¸ì¸ ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."):alert("ì„¤ë¬¸ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}}else alert("ëª¨ë“  í•„ìˆ˜ í•­ëª©ì— ë‹µë³€í•´ì£¼ì„¸ìš”.")},B=()=>{confirm("ì‘ì„±í•œ ë‚´ìš©ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(Object.keys(c.value).forEach(t=>c.value[t]=null),y.value="",r.value=!1,x(),o.value=1)},F=D(()=>c.value["q"+o.value]!==null),$=D(()=>Object.values(c.value).every(t=>t!==null));return J(async()=>{x(),await Promise.all([M(),C()]),await A()}),(t,e)=>(i(),u("div",te,[e[10]||(e[10]=s("div",{class:"survey-header"},[s("h1",null,"ì¤‘ê°„ê°•ì˜í‰ê°€ ì„¤ë¬¸ì§€")],-1)),s("div",le,[e[6]||(e[6]=s("h5",null,"ğŸ“š ê°•ì˜ ì •ë³´",-1)),w.value?(i(),u("div",oe,e[1]||(e[1]=[s("div",{class:"spinner"},null,-1),s("p",null,"ê°•ì˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)]))):_.value?(i(),u("div",ae,[s("p",ne,"âš ï¸ "+n(_.value),1),s("button",{onClick:C,class:"btn btn-sm btn-outline-primary"}," ë‹¤ì‹œ ì‹œë„ ")])):(i(),u("div",re,[s("div",ue,[s("p",null,[e[2]||(e[2]=s("strong",null,"ê³¼ëª©ëª…:",-1)),g(" "+n(v.value.title),1)]),s("p",null,[e[3]||(e[3]=s("strong",null,"ë‹´ë‹¹êµìˆ˜:",-1)),g(" "+n(v.value.professorName),1)])]),s("div",ie,[s("p",null,[e[4]||(e[4]=s("strong",null,"í•™ì :",-1)),g(" "+n(v.value.credit)+"í•™ì ",1)]),s("p",null,[e[5]||(e[5]=s("strong",null,"ì´ìˆ˜êµ¬ë¶„:",-1)),g(" "+n(v.value.type),1)])])]))]),s("div",ce,[s("div",{class:"progress-bar",role:"progressbar",style:Y({width:I.value+"%"})},null,4)]),s("p",de," ì§„í–‰ë¥ : "+n(I.value)+"% ("+n(o.value)+"/"+n(d+1)+"ë‹¨ê³„) ",1),s("form",{onSubmit:se(z,["prevent"]),class:ee({"form-disabled":r.value})},[o.value<=d?(i(),u("div",ve,[s("div",pe,[s("div",me,n(S[o.value-1].number),1),s("div",be,n(S[o.value-1].question),1)]),s("div",ye,[s("div",_e,[(i(),u(G,null,W(j,l=>s("div",{key:l.value,class:"rating-option"},[s("div",fe,n(l.label),1),s("div",ge,[s("input",{class:"rating-input",type:"radio",name:"q"+o.value,id:"q"+o.value+"_"+l.value,value:l.value,"data-value":l.value,onInput:p=>T(l.value),checked:c.value["q"+o.value]==l.value,disabled:r.value},null,40,he)])])),64))])])])):m("",!0),o.value===d+1?(i(),u("div",qe,[e[7]||(e[7]=s("div",{class:"question-header"},[s("div",{class:"question-number"},"ğŸ’¬"),s("div",{class:"question-text"}," ê°•ì˜ì— ëŒ€í•œ ì¶”ê°€ ì˜ê²¬ì´ë‚˜ ê°œì„ ì‚¬í•­ì´ ìˆë‹¤ë©´ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”. ")],-1)),s("div",Ie,[X(s("textarea",{class:"form-control opinion-textarea",rows:"6",placeholder:"ê°•ì˜ ê°œì„ ì„ ìœ„í•œ ì˜ê²¬ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”...","onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),disabled:r.value},null,8,we),[[Z,y.value]])])])):m("",!0),s("div",ke,[s("button",{type:"button",class:"btn btn-outline-secondary btn-lg me-3",onClick:V,disabled:o.value===1||r.value}," â† ì´ì „ ",8,xe),o.value<=d?(i(),u("button",{key:0,type:"button",class:"btn btn-primary btn-lg",onClick:U,disabled:!F.value||r.value}," ë‹¤ìŒ â†’ ",8,Se)):m("",!0),o.value===d+1?(i(),u("button",{key:1,type:"submit",class:"btn btn-success btn-lg",disabled:r.value||!$.value}," ğŸ“ ì„¤ë¬¸ ì œì¶œ ",8,Ce)):m("",!0),s("button",{type:"button",class:"btn btn-outline-secondary btn-lg ms-3",onClick:B,disabled:r.value}," ğŸ”„ ë‹¤ì‹œ ì‘ì„± ",8,De),e[8]||(e[8]=s("p",{class:"text-muted mt-3 mb-0"}," ìµëª…ìœ¼ë¡œ ì œì¶œë˜ë©°, ê°•ì˜ ê°œì„ ì— ì†Œì¤‘í•œ ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤. ",-1))]),r.value?(i(),u("div",Ee,e[9]||(e[9]=[s("h4",null,"ğŸ‰ ì œì¶œ ì™„ë£Œ!",-1),s("p",null," ì„¤ë¬¸ì— ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë” ë‚˜ì€ ê°•ì˜ë¥¼ ìœ„í•´ ì†Œì¤‘í•œ ì˜ê²¬ì„ ë°˜ì˜í•˜ê² ìŠµë‹ˆë‹¤. ",-1)]))):m("",!0)],34)]))}};export{Pe as default};
