import{P as E,_ as $,r as p,a as D,q as _,t as F,k as R,d as O,o,h as A,b as s,c as n,H as d,e as c,F as k,E as w,J as B,g as v,M as m,$ as K,v as W}from"./index-BYEgPVgA.js";import{W as q}from"./WhiteBox-2PWihVXJ.js";import{c as U}from"./DeptManageService-D94py_XW.js";/* empty css                                                                 */const z=async x=>{const{data:y}=await E.get("/staff/member",{params:x});return y},G={class:"filters"},H={class:"chips"},J={class:"right"},Q=["value"],j=["value"],X=["value"],Y={class:"search-group"},Z=["placeholder"],ee={class:"table-wrap"},te={key:0,class:"center dim"},se={key:1,class:"center err"},ae={key:2,class:"tbl"},le={style:{width:"140px"}},oe={key:0},ne={key:0},de={key:1,class:"muted"},re={key:1},ie={class:"muted ellipsis"},ue={class:"muted"},pe={class:"muted ellipsis"},ve={key:0},ce={__name:"MemberListPage",setup(x){const y=p([{id:"",name:"전체"}]),I=p(!1);async function C(){I.value=!0;try{const l=await U(),e=Array.isArray(l)?l:Array.isArray(l==null?void 0:l.data)?l.data:Array.isArray(l==null?void 0:l.list)?l.list:[];if(!Array.isArray(e))throw new Error("Invalid department response");const t=e.map(r=>({id:r.deptId??r.id,name:r.deptName??r.name}));y.value=[{id:"",name:"전체"}].concat(t.filter(r=>r.id!=null&&r.name).sort((r,P)=>String(r.name).localeCompare(String(P.name),"ko")))}catch(l){console.error("학과 로딩 실패",l,"(응답=",await Promise.resolve(U()).catch(()=>"N/A"),")")}finally{I.value=!1}}const M=[{value:"",label:"상태: 전체"},{value:"재학",label:"재학"},{value:"휴학",label:"휴학"},{value:"졸업",label:"졸업"}],N=[{value:"",label:"상태: 전체"},{value:"재직",label:"재직"},{value:"휴직",label:"휴직"},{value:"퇴직",label:"퇴직"}],i=p("student"),b=p(!1),g=p(""),h=p([]),a=D({deptId:"",status:"",grade:"",keyword:"",searchBy:"all"}),u=_(()=>i.value==="student"),V=_(()=>u.value?"학생":"교수"),T=_(()=>u.value?M:N);async function f(){b.value=!0,g.value="";try{const l={userRole:i.value,deptId:a.deptId!==""?Number(a.deptId):void 0,status:a.status||void 0,keyword:a.keyword||void 0,searchBy:a.searchBy!=="all"?a.searchBy:void 0};u.value&&a.grade&&(l.grade=Number(a.grade)),a.gender&&(l.gender=a.gender);const e=await z(l);h.value=e}catch(l){console.error(l),g.value="목록을 불러오지 못했습니다."}finally{b.value=!1}}function S(l){i.value!==l&&(i.value=l,a.gender="",a.grade="",a.status="")}function L(){a.keyword=""}return F([i,()=>a.deptId,()=>a.status,()=>a.gender,()=>a.grade],f),R(async()=>{await C(),await f()}),(l,e)=>(o(),O(q,{title:"구성원 관리",bodyPadding:"0"},{header:A(()=>[s("div",G,[s("div",H,[s("button",{class:B(["chip",{on:i.value==="student"}]),onClick:e[0]||(e[0]=t=>S("student"))},"학생",2),s("button",{class:B(["chip",{on:i.value==="professor"}]),onClick:e[1]||(e[1]=t=>S("professor"))},"교수",2)]),s("div",J,[v(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.deptId=t),class:"inp w150"},[(o(!0),n(k,null,w(y.value,t=>(o(),n("option",{value:t.id,key:t.id},d(t.name),9,Q))),128))],512),[[m,a.deptId]]),v(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.status=t),class:"inp w120"},[(o(!0),n(k,null,w(T.value,t=>(o(),n("option",{key:t.value,value:t.value},d(t.label),9,j))),128))],512),[[m,a.status]]),u.value?v((o(),n("select",{key:0,"onUpdate:modelValue":e[4]||(e[4]=t=>a.grade=t),class:"inp w120"},[e[8]||(e[8]=s("option",{value:""},"학년: 전체",-1)),(o(),n(k,null,w(4,t=>s("option",{key:t,value:t},d(t)+"학년",9,X)),64))],512)),[[m,a.grade]]):c("",!0),v(s("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.gender=t),class:"inp w100"},e[9]||(e[9]=[s("option",{value:""},"성별: 전체",-1),s("option",{value:"M"},"남",-1),s("option",{value:"F"},"여",-1)]),512),[[m,a.gender]]),s("div",Y,[v(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>a.searchBy=t),class:"inp w120"},e[10]||(e[10]=[s("option",{value:"all"},"전체",-1),s("option",{value:"name"},"이름",-1),s("option",{value:"loginId"},"아이디",-1),s("option",{value:"email"},"이메일",-1)]),512),[[m,a.searchBy]]),v(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.keyword=t),type:"text",class:"inp w240",placeholder:u.value?"이름 또는 학번 검색":"이름 또는 아이디 검색",onKeyup:K(f,["enter"])},null,40,Z),[[W,a.keyword]]),a.keyword?(o(),n("button",{key:0,class:"ghost",onClick:L},"지움")):c("",!0)]),s("button",{class:"primary",onClick:f},"조회")])])]),default:A(()=>[s("div",ee,[b.value?(o(),n("div",te,"불러오는 중…")):g.value?(o(),n("div",se,d(g.value),1)):(o(),n("table",ae,[s("thead",null,[s("tr",null,[e[11]||(e[11]=s("th",{style:{width:"140px"}},"아이디",-1)),e[12]||(e[12]=s("th",{style:{width:"140px"}},"이름",-1)),e[13]||(e[13]=s("th",null,"학과",-1)),s("th",le,d(V.value)+" 정보",1),e[14]||(e[14]=s("th",{style:{width:"240px"}},"이메일",-1)),e[15]||(e[15]=s("th",{style:{width:"140px"}},"전화",-1)),e[16]||(e[16]=s("th",null,"주소",-1))])]),s("tbody",null,[(o(!0),n(k,null,w(h.value,t=>(o(),n("tr",{key:`${t.loginId}-${t.username}`},[s("td",null,d(t.loginId),1),s("td",null,d(t.username),1),s("td",null,d(t.deptName),1),u.value?(o(),n("td",oe,[t.grade?(o(),n("span",ne,d(t.grade)+"학년",1)):c("",!0),t.status?(o(),n("span",de," / "+d(t.status),1)):c("",!0)])):(o(),n("td",re,[s("span",null,d(t.status||"-"),1)])),s("td",ie,d(t.email),1),s("td",ue,d(t.phone),1),s("td",pe,d(t.address),1)]))),128)),h.value.length?c("",!0):(o(),n("tr",ve,e[17]||(e[17]=[s("td",{colspan:"7",class:"center dim"},"결과가 없습니다.",-1)])))])]))])]),_:1}))}},ke=$(ce,[["__scopeId","data-v-c9329d8e"]]);export{ke as default};
