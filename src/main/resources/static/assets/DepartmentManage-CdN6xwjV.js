import{_ as w,a as h,k as $,d as O,o as r,h as k,b as e,c as i,F as c,g as n,v as f,E as C,H as p,M as S,f as P,t as U,e as u,C as N,w as D,$ as _,J as B}from"./index-BYEgPVgA.js";import{W as I}from"./WhiteBox-2PWihVXJ.js";import{d as L,a as j,b as E,c as F,e as G}from"./DeptManageService-D94py_XW.js";import{M as H}from"./Modal-CpxjMeC7.js";/* empty css                                                                 */const K={class:"frame"},W={class:"select-box"},z={class:"select-item"},A=["checked"],J={class:"select-item"},Z=["checked"],q={class:"box"},Q={class:"box"},R={class:"box"},X=["value"],Y={class:"box"},ee={class:"box"},te={class:"box"},se={class:"box"},oe={__name:"DeptUpdateModal",props:{dept:Object},emits:["close"],setup(M,{emit:s}){const a=M,d=h({form:{deptId:a.dept.deptId,headProfId:a.dept.headProfId,deptName:a.dept.deptName,deptOffice:a.dept.deptOffice,deptTel:a.dept.deptTel,deptMaxStd:a.dept.deptMaxStd,deptCode:a.dept.deptCode},professor:[],checked:!0});console.log("학과번호:",a.dept.deptId),$(async()=>{if(!a.dept)return;const l=await L(a.dept.deptId);d.professor=l.data,console.log("알이에스:",l.data)});const b=l=>{if(l===1){d.checked=!0;return}d.checked=!1},v=async()=>{try{d.checked===!1?await j(d.form.deptId):await E(d.form),m()}catch(l){console.error(l),alert("업데이트 중 오류 발생")}},y=s,m=()=>{y("close")};return(l,t)=>(r(),O(H,{title:"학과 정보 변경",onClose:m},{default:k(()=>[e("div",K,[t[19]||(t[19]=e("p",null,"작업 선택",-1)),e("div",W,[e("div",z,[e("input",{type:"radio",name:"select",onClick:t[0]||(t[0]=o=>b(1)),checked:d.checked},null,8,A),t[9]||(t[9]=e("label",{class:"form-check-label"},"학과 정보 변경",-1))]),e("div",J,[e("input",{type:"radio",name:"select",onClick:t[1]||(t[1]=o=>b(0)),checked:!d.checked},null,8,Z),t[10]||(t[10]=e("label",{class:"form-check-label"},"학과 폐지",-1))])]),d.checked?(r(),i(c,{key:0},[e("div",q,[t[11]||(t[11]=e("label",{class:"code",for:"d-code"},"학과코드",-1)),n(e("input",{type:"text",id:"d-code","onUpdate:modelValue":t[2]||(t[2]=o=>d.form.deptCode=o)},null,512),[[f,d.form.deptCode]])]),e("div",Q,[t[12]||(t[12]=e("label",{class:"code",for:"d-name"},"학과명",-1)),n(e("input",{type:"text",id:"d-name","onUpdate:modelValue":t[3]||(t[3]=o=>d.form.deptName=o)},null,512),[[f,d.form.deptName]])]),e("div",R,[t[13]||(t[13]=e("label",{class:"code",for:"d-head"},"학과장명",-1)),n(e("select",{name:"headName",id:"d-head",class:"d-head","onUpdate:modelValue":t[4]||(t[4]=o=>d.form.headProfId=o)},[(r(!0),i(c,null,C(d.professor,o=>(r(),i("option",{value:o.userId},p(o.userName),9,X))),256))],512),[[S,d.form.headProfId]])]),e("div",Y,[t[14]||(t[14]=e("label",{class:"code",for:"d-office"},"학과 사무실",-1)),n(e("input",{type:"text",id:"d-office","onUpdate:modelValue":t[5]||(t[5]=o=>d.form.deptOffice=o)},null,512),[[f,d.form.deptOffice]])]),e("div",ee,[t[15]||(t[15]=e("label",{class:"code",for:"d-tel"},"학과 전화번호",-1)),n(e("input",{type:"text",id:"d-tel","onUpdate:modelValue":t[6]||(t[6]=o=>d.form.deptTel=o)},null,512),[[f,d.form.deptTel]])]),e("div",te,[t[16]||(t[16]=e("label",{class:"code",for:"d-max"},"학과 정원",-1)),n(e("input",{type:"text",id:"d-max","onUpdate:modelValue":t[7]||(t[7]=o=>d.form.deptMaxStd=o)},null,512),[[f,d.form.deptMaxStd]])]),e("div",{class:"button"},[e("button",{class:"btn btn-light",onClick:m},"취소"),e("button",{class:"btn btn-success",onClick:v},"수정")])],64)):(r(),i(c,{key:1},[e("div",se,[t[17]||(t[17]=e("label",{class:"code",for:"d-code"},"학과 코드",-1)),n(e("input",{type:"text",id:"d-code",placeholder:"예:CSE001","onUpdate:modelValue":t[8]||(t[8]=o=>d.form.deptCode=o)},null,512),[[f,d.form.deptCode]])]),t[18]||(t[18]=e("div",{class:"alert"},[e("span",null,[e("b",null,"경고:"),P(" 학과를 폐지하시겠습니까? 이 작업은 되돌릴 수 없습니다.")])],-1)),e("div",{class:"button"},[e("button",{class:"btn btn-light",onClick:m},"취소"),e("button",{class:"btn btn-danger",onClick:v},"폐지")])],64))])]),_:1}))}},de=w(oe,[["__scopeId","data-v-2667cb7f"]]),le={class:"dept-form-container"},re={class:"dept-form-grid"},ae={class:"tab"},ne={key:0,class:"error"},pe={class:"tab"},ie={key:0,class:"error"},fe={class:"tab"},ue={class:"tab"},me={key:0,class:"error"},ce={class:"tab"},be={key:0,class:"error"},xe={class:"tab"},ve={key:0,class:"error"},ye={class:"d-flex filter-bar"},ke={class:"cover d-flex"},Ce={class:"cover d-flex"},Me={class:"container"},Ne={class:"table-wrapper"},Ie={class:"title-line"},we={class:"dept-table"},he={class:"dept-btn"},$e={class:"body-line"},Oe={class:"dept-table"},Se={class:"btn-td"},Te=["onClick"],Ve={__name:"DepartmentManage",setup(M){const s=h({form:{deptName:"",headProfId:0,deptOffice:"",deptTel:"",deptMaxStd:0,deptCode:""},errors:{deptName:null,headProfId:null,deptOffice:null,deptTel:null,deptMaxStd:null,deptCode:null},deptList:[],search:{keyword:"",status:""},showModal:!1,selectItem:null}),a=async l=>{const t=await F(l);console.log("알이에수",t),s.deptList=t.data,console.log("list",s.deptList)},d=async()=>{a(s.search)};$(async()=>{a()});const b=l=>{switch(l){case"deptCode":const t=/^[A-Z]{4}$/;s.errors.deptCode=t.test(s.form.deptCode)?null:"학과코드는 영어 대문자 4자로 구성되어야 합니다.";break;case"deptTel":const o=/^\d{2,3}-\d{3,4}-\d{4}$/;s.errors.deptTel=s.form.deptTel&&!o.test(s.form.deptTel)?"전화번호 형식이 올바르지 않습니다 (예: 02-123-4567).":null;break;case"deptMaxStd":const x=Number(s.form.deptMaxStd);s.errors.deptMaxStd=isNaN(x)||x<300||x>=500?"학과 정원은 300명 이상 500명 미만이어야 합니다.":null;break;case"deptName":s.errors.deptName=s.form.deptName?null:"학과명은 필수 항목입니다.";break;case"deptOffice":s.errors.deptOffice=s.form.deptOffice?null:"학과 사무실은 필수 항목입니다.";break}};Object.keys(s.form).forEach(l=>{U(()=>s.form[l],()=>b(l))});const v=async()=>{if(Object.keys(s.form).forEach(l=>b(l)),Object.values(s.errors).some(l=>l)){alert("입력값을 확인해주세요.");return}if(confirm("학과를 개설 하시겠습니까?")){s.form.headProfId===0&&(s.form.headProfId=null);try{const l=await G(s.form);console.log(l),a(),alert("학과가 성공적으로 개설되었습니다.")}catch(l){console.error("학과 개설 중 에러:",l),alert("학과 개설 중 오류가 발생했습니다.")}}},y=l=>{s.selectItem=l,s.showModal=!0},m=()=>{s.showModal=!1,a()};return(l,t)=>(r(),i(c,null,[s.showModal===!0?(r(),O(de,{key:0,onClose:m,dept:s.selectItem},null,8,["dept"])):u("",!0),N(I,{title:"학과관리",class:"white1"},{default:k(()=>[e("div",le,[e("form",{onSubmit:D(v,["prevent"])},[e("div",re,[e("div",ae,[t[9]||(t[9]=e("label",{for:"deptCode",class:"form-label"},[e("b",null,"학과코드")],-1)),n(e("input",{type:"text",id:"deptCode",maxlength:"4",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=o=>s.form.deptCode=o)},null,512),[[f,s.form.deptCode]]),s.errors.deptCode?(r(),i("span",ne,p(s.errors.deptCode),1)):u("",!0)]),e("div",pe,[t[10]||(t[10]=e("label",{for:"deptName",class:"form-label"},[e("b",null,"학과명")],-1)),n(e("input",{type:"text",id:"deptName",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=o=>s.form.deptName=o)},null,512),[[f,s.form.deptName]]),s.errors.deptName?(r(),i("span",ie,p(s.errors.deptName),1)):u("",!0)]),e("div",fe,[t[11]||(t[11]=e("label",{for:"headProfId",class:"form-label"},[e("b",null,"학과장명")],-1)),n(e("input",{type:"text",id:"headProfId",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=o=>s.form.headProfId=o)},null,512),[[f,s.form.headProfId]])]),e("div",ue,[t[12]||(t[12]=e("label",{for:"deptOffice",class:"form-label"},[e("b",null,"학과 사무실")],-1)),n(e("input",{type:"text",id:"deptOffice",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=o=>s.form.deptOffice=o)},null,512),[[f,s.form.deptOffice]]),s.errors.deptOffice?(r(),i("span",me,p(s.errors.deptOffice),1)):u("",!0)]),e("div",ce,[t[13]||(t[13]=e("label",{for:"deptTel",class:"form-label"},[e("b",null,"학과 전화번호")],-1)),n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.form.deptTel=o),onInput:t[5]||(t[5]=o=>{s.form.deptTel=s.form.deptTel.replace(/\D/g,"").replace(/^(\d{0,2})(\d{0,3})(\d{0,4}).*/,(x,T,V,g)=>[T,V,g].filter(Boolean).join("-"))})},null,544),[[f,s.form.deptTel]]),s.errors.deptTel?(r(),i("span",be,p(s.errors.deptTel),1)):u("",!0)]),e("div",xe,[t[14]||(t[14]=e("label",{for:"deptMaxStd",class:"form-label"},[e("b",null,"학과 정원")],-1)),n(e("input",{type:"text",id:"deptMaxStd",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=o=>s.form.deptMaxStd=o)},null,512),[[f,s.form.deptMaxStd]]),s.errors.deptMaxStd?(r(),i("span",ve,p(s.errors.deptMaxStd),1)):u("",!0)])]),t[15]||(t[15]=e("div",{class:"form-actions"},[e("button",{type:"submit",class:"btn btn-primary"},"학과개설")],-1))],32)])]),_:1}),N(I,{class:"white2"},{default:k(()=>[e("div",ye,[e("div",ke,[t[16]||(t[16]=e("div",{class:"search"},[e("i",{class:"bi bi-search"})],-1)),n(e("input",{type:"text",placeholder:"학과명을 입력하세요","onUpdate:modelValue":t[7]||(t[7]=o=>s.search.keyword=o)},null,512),[[f,s.search.keyword]])]),e("div",Ce,[t[18]||(t[18]=e("div",{class:"search"},[e("i",{class:"bi bi-funnel"})],-1)),n(e("select",{name:"filter",class:"filter","onUpdate:modelValue":t[8]||(t[8]=o=>s.search.status=o)},t[17]||(t[17]=[e("option",{value:""},"상태/전체",-1),e("option",{value:"1"},"운영중",-1),e("option",{value:"0"},"폐지",-1)]),512),[[S,s.search.status]])]),e("button",{class:"btn btn-success",onClick:d,onKeyup:_(d,["enter"])},"조회",32)]),e("div",Me,[e("div",Ne,[e("div",Ie,[e("table",we,[e("thead",null,[e("tr",null,[t[19]||(t[19]=e("th",{class:"dept-code"},"학과코드",-1)),t[20]||(t[20]=e("th",{class:"dept-name"},"학과",-1)),t[21]||(t[21]=e("th",{class:"dept-office"},"학과사무실",-1)),t[22]||(t[22]=e("th",{class:"dept-head"},"학과장명",-1)),t[23]||(t[23]=e("th",{class:"dept-tel"},"학과 전화번호",-1)),t[24]||(t[24]=e("th",{class:"dept-max"},"학과 정원",-1)),t[25]||(t[25]=e("th",{class:"dept-people"},"학과 인원",-1)),t[26]||(t[26]=e("th",{class:"dept-status"},"상태",-1)),e("th",he,[(r(),i(c,null,C(10,o=>e("span",{key:o}," ")),64))])])])])]),e("div",$e,[e("table",Oe,[e("tbody",null,[(r(!0),i(c,null,C(s.deptList,o=>(r(),i("tr",{key:o.deptId,class:"tr-line"},[e("td",null,p(o.deptCode),1),e("td",null,p(o.deptName),1),e("td",null,p(o.deptOffice),1),e("td",null,p(o.userName===null?"-":o.userName),1),e("td",null,p(o.deptTel),1),e("td",null,p(o.deptMaxStd),1),e("td",null,p(o.deptPeople),1),e("td",{class:B(o.status==="0"?"not-do":"do")},p(o.status==="1"?"운영중":"폐지"),3),e("td",Se,[o.status==="1"?(r(),i("button",{key:0,class:"btn btn-primary",onClick:x=>y(o)},"수정",8,Te)):u("",!0)])]))),128))])])])])])]),_:1})],64))}},Be=w(Ve,[["__scopeId","data-v-95591658"]]);export{Be as default};
